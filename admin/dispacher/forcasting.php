<div class="header">
    <a>Forescasting</a>
</div>

<div class="page-forecasting">
    <form action="" method="POST">
        <input type="submit" name="Submit" value="Forecasting">
    </form>
    <!-- <div class="data-beban"></div> -->
  <?php
  if (isset($_POST['Submit'])) {
    $data_beban = array(); // Array data beban
    $energi_harian = array();
    $energi_mingguan = array();

// Isi array data beban dengan 1344 data (contoh data acak)
$data_beban = [
69.43,
68.49,
68.29,
67.40,
67.17,
66.18,
65.51,
65.96,
65.57,
64.93,
64.87,
63.23,
60.69,
59.98,
59.52,
59.61,
57.52,
55.49,
55.43,
55.58,
55.90,
55.62,
55.68,
55.39,
55.16,
55.72,
56.42,
55.87,
55.60,
55.51,
55.39,
54.16,
54.85,
55.25,
57.03,
60.61,
68.81,
81.01,
85.76,
84.47,
83.23,
82.42,
81.08,
79.41,
77.64,
75.76,
73.64,
73.09,
71.79,
70.70,
69.18,
68.22,
66.72,
65.80,
64.92,
64.48,
63.74,
63.97,
63.80,
62.38,
59.96,
60.31,
61.07,
62.48,
64.45,
65.80,
67.33,
68.12,
68.54,
68.93,
67.57,
67.50,
67.14,
67.21,
67.45,
66.73,
66.17,
65.75,
65.90,
65.57,
65.93,
65.36,
65.88,
70.58,
79.66,
90.59,
92.95,
91.45,
88.93,
87.07,
85.05,
83.57,
81.11,
78.78,
76.62,
74.70,
73.44,
71.91,
70.88,
69.61,
68.99,
67.88,
67.83,
65.51,
64.97,
62.57,
63.33,
62.09,
62.07,
62.47,
61.25,
62.51,
64.34,
67.93,
69.04,
70.08,
70.74,
70.30,
69.41,
69.88,
69.73,
69.65,
69.69,
69.48,
68.69,
68.86,
68.82,
66.62,
66.50,
66.07,
66.78,
70.26,
77.46,
87.72,
91.89,
90.33,
87.97,
85.11,
81.96,
79.70,
76.90,
74.29,
71.91,
70.28,
69.15,
67.75,
66.91,
65.73,
63.79,
63.08,
61.79,
61.98,
61.27,
59.92,
60.13,
59.68,
59.32,
58.50,
59.06,
61.05,
63.08,
65.95,
67.32,
69.91,
69.86,
68.85,
69.43,
68.76,
66.91,
69.42,
68.29,
69.15,
69.33,
69.33,
69.06,
69.26,
68.46,
61.45,
65.49,
68.86,
75.94,
88.85,
92.55,
90.37,
88.64,
86.46,
84.67,
82.35,
78.33,
76.22,
74.29,
65.26,
64.16,
62.85,
68.29,
66.82,
63.94,
63.97,
62.91,
61.47,
61.28,
63.35,
62.77,
61.87,
56.30,
60.55,
62.05,
63.14,
66.31,
69.52,
70.76,
70.92,
72.65,
72.75,
73.12,
72.40,
72.00,
69.08,
68.63,
69.39,
69.41,
61.67,
61.29,
62.30,
65.34,
65.98,
67.22,
70.10,
77.10,
91.35,
93.11,
89.18,
87.44,
84.84,
83.66,
81.27,
77.37,
75.35,
73.55,
71.44,
69.24,
67.16,
66.73,
65.67,
64.81,
62.35,
62.14,
62.64,
62.05,
62.56,
63.03,
62.08,
60.58,
61.20,
61.90,
62.18,
65.06,
66.88,
69.34,
70.41,
70.88,
70.08,
70.85,
69.72,
69.60,
70.38,
70.95,
70.71,
70.67,
71.43,
71.24,
70.35,
70.42,
70.59,
69.73,
70.01,
76.09,
94.05,
97.88,
94.99,
92.31,
90.21,
87.54,
83.85,
81.17,
78.02,
76.22,
72.49,
71.39,
70.20,
69.20,
67.97,
66.52,
66.03,
64.93,
64.20,
63.93,
63.61,
63.56,
61.60,
58.96,
59.36,
59.48,
58.95,
60.28,
61.63,
63.06,
63.44,
63.82,
65.04,
65.19,
64.90,
64.94,
63.99,
63.48,
62.31,
63.69,
64.17,
64.16,
63.17,
63.88,
64.29,
65.57,
67.40,
72.41,
88.92,
95.24,
96.23,
92.95,
90.31,
88.21,
85.61,
82.38,
79.40,
74.58,
72.33,
70.57,
69.22,
68.01,
68.14,
67.24,
66.11,
65.23,
64.05,
63.42,
63.09,
63.20,
61.44,
58.35,
59.20,
59.50,
59.41,
59.95,
60.68,
61.30,
61.85,
63.08,
63.75,
63.97,
63.80,
63.04,
62.55,
62.11,
61.53,
61.31,
62.01,
61.68,
61.33,
62.10,
62.68,
63.83,
66.05,
72.25,
88.95,
96.09,
95.49,
93.02,
90.72,
88.41,
85.42,
82.16,
79.19,
76.49,
74.14,
72.00,
70.64,
68.73,
67.83,
66.77,
66.01,
64.75,
64.26,
64.10,
64.20,
64.99,
65.73,
64.91,
63.63,
61.71,
62.44,
65.01,
67.61,
70.33,
71.83,
73.87,
74.75,
77.31,
77.45,
77.43,
77.63,
77.77,
78.04,
78.02,
77.06,
77.18,
76.48,
76.04,
74.24,
71.63,
72.49,
80.28,
98.02,
104.67,
102.70,
99.51,
96.08,
92.83,
89.76,
86.47,
83.21,
80.28,
78.15,
76.12,
74.57,
72.61,
71.38,
70.67,
69.41,
68.37,
67.34,
67.16,
67.32,
67.63,
66.88,
65.60,
65.21,
64.32,
65.43,
68.42,
70.85,
73.18,
73.47,
75.00,
76.07,
76.62,
77.16,
76.73,
76.16,
76.56,
77.33,
77.42,
77.60,
76.88,
76.33,
76.02,
74.98,
74.73,
75.81,
80.21,
95.67,
103.89,
102.67,
99.31,
96.55,
93.31,
90.09,
86.54,
83.03,
80.20,
77.52,
75.47,
73.58,
72.30,
70.95,
69.91,
69.19,
68.60,
68.12,
67.78,
67.60,
68.00,
63.34,
62.76,
64.15,
61.70,
61.86,
63.88,
69.62,
71.35,
72.71,
73.80,
74.41,
74.86,
75.63,
75.69,
75.52,
75.90,
75.83,
74.29,
75.00,
75.21,
75.36,
76.20,
75.74,
75.38,
76.53,
82.01,
95.50,
102.28,
98.18,
97.64,
94.90,
91.49,
88.40,
85.14,
81.45,
78.67,
76.01,
73.49,
72.48,
71.12,
69.94,
69.12,
67.73,
67.01,
66.48,
65.91,
66.17,
66.89,
66.55,
65.94,
66.38,
65.17,
65.38,
67.90,
70.36,
72.55,
73.89,
74.63,
75.80,
76.39,
77.27,
77.26,
76.87,
77.53,
77.73,
77.74,
76.71,
76.38,
75.95,
75.11,
74.52,
75.62,
78.52,
84.40,
99.06,
104.43,
102.28,
98.83,
95.92,
93.17,
90.09,
86.36,
82.77,
80.78,
77.92,
76.24,
74.49,
72.90,
71.99,
70.75,
70.04,
69.01,
68.41,
67.94,
68.37,
68.74,
69.15,
68.41,
68.29,
66.48,
66.85,
68.57,
69.44,
71.16,
72.59,
74.23,
75.24,
75.87,
76.35,
76.32,
75.40,
75.17,
76.17,
75.96,
76.22,
76.42,
75.40,
75.65,
75.08,
74.77,
75.04,
80.37,
97.74,
104.23,
101.88,
98.55,
95.81,
92.79,
89.37,
86.38,
82.68,
80.13,
77.65,
75.48,
73.88,
72.42,
71.46,
70.51,
69.58,
68.52,
67.95,
67.41,
67.40,
67.46,
66.62,
63.77,
63.02,
61.78,
61.68,
62.26,
64.72,
66.23,
64.23,
65.79,
65.94,
66.76,
66.81,
66.54,
66.42,
66.27,
66.91,
66.33,
67.28,
66.97,
66.36,
66.17,
66.86,
67.88,
69.18,
73.02,
93.66,
102.33,
100.63,
98.04,
94.99,
91.76,
89.19,
85.76,
82.32,
80.20,
78.26,
44.23,
63.73,
72.59,
71.42,
70.69,
69.91,
69.19,
68.43,
68.14,
67.09,
66.20,
65.49,
61.83,
61.37,
60.85,
60.92,
60.84,
62.04,
62.69,
64.22,
65.09,
65.99,
67.05,
66.47,
66.26,
65.77,
65.11,
64.83,
64.56,
64.75,
64.79,
64.60,
65.21,
66.18,
66.62,
67.81,
73.40,
90.43,
96.22,
89.00,
86.65,
85.51,
83.52,
81.02,
78.61,
76.34,
73.87,
71.55,
70.08,
68.58,
67.06,
72.38,
71.27,
70.27,
69.54,
68.68,
68.35,
68.65,
69.06,
69.81,
70.14,
68.66,
65.34,
65.45,
65.56,
65.66,
66.73,
68.48,
70.27,
71.17,
71.26,
71.86,
70.74,
69.30,
70.05,
70.19,
68.89,
68.27,
67.19,
66.94,
66.73,
66.42,
68.34,
69.87,
76.89,
93.10,
97.17,
94.74,
92.36,
90.42,
87.57,
83.84,
80.39,
77.08,
73.91,
71.46,
69.55,
67.66,
66.67,
65.40,
64.62,
64.09,
64.02,
62.71,
62.46,
63.03,
64.01,
65.06,
64.53,
64.70,
62.42,
63.20,
65.24,
67.86,
69.98,
71.94,
72.83,
69.73,
74.82,
73.85,
73.95,
73.65,
74.31,
74.80,
75.06,
75.39,
75.09,
74.68,
74.82,
74.67,
75.51,
75.39,
81.12,
95.20,
102.63,
102.48,
98.81,
95.88,
94.09,
90.93,
87.00,
81.77,
78.73,
76.94,
74.97,
73.02,
71.10,
69.94,
68.88,
68.16,
67.34,
65.99,
66.09,
65.92,
66.86,
67.50,
67.14,
67.26,
64.35,
64.17,
66.85,
69.04,
70.23,
71.39,
72.63,
73.50,
73.73,
75.57,
75.51,
74.99,
75.88,
76.29,
77.36,
78.14,
77.39,
77.19,
76.32,
75.27,
74.49,
75.43,
83.13,
101.48,
105.04,
102.39,
99.47,
96.54,
93.58,
90.26,
86.93,
83.83,
80.92,
78.66,
76.38,
73.58,
72.51,
71.01,
70.73,
70.05,
68.32,
68.56,
68.24,
68.36,
69.02,
69.26,
67.88,
67.29,
65.94,
66.71,
67.56,
70.19,
72.49,
75.07,
76.04,
75.97,
76.37,
76.19,
75.80,
74.74,
74.88,
74.69,
75.24,
75.01,
74.53,
75.48,
75.26,
74.59,
74.13,
75.95,
82.37,
99.66,
105.17,
103.10,
99.67,
96.76,
91.42,
88.03,
84.22,
79.45,
77.41,
74.60,
72.77,
71.33,
70.09,
68.95,
68.11,
66.56,
66.15,
65.28,
64.56,
64.43,
64.95,
65.98,
65.96,
65.47,
63.19,
62.76,
64.69,
66.27,
68.14,
68.42,
68.97,
69.89,
69.19,
68.89,
69.20,
69.75,
69.94,
70.31,
70.94,
70.88,
71.01,
70.54,
70.30,
69.52,
69.22,
70.63,
77.54,
95.58,
101.03,
98.79,
95.85,
93.36,
88.46,
86.69,
82.90,
79.80,
77.11,
74.59,
72.25,
70.47,
69.46,
68.19,
67.30,
66.10,
65.98,
65.12,
64.69,
64.83,
65.11,
64.91,
62.84,
61.98,
60.70,
60.13,
60.72,
60.28,
60.67,
62.76,
63.23,
65.07,
65.98,
65.51,
66.11,
66.01,
65.80,
66.15,
66.14,
65.76,
65.96,
67.24,
67.00,
65.35,
67.81,
70.22,
75.87,
91.70,
98.74,
97.11,
93.92,
91.35,
88.43,
85.68,
82.24,
79.12,
76.62,
74.51,
72.51,
70.74,
69.59,
68.39,
67.37,
66.19,
65.24,
64.62,
63.97,
64.34,
64.62,
64.46,
60.38,
59.90,
60.63,
60.55,
60.94,
61.14,
62.22,
62.94,
63.79,
64.59,
65.27,
65.81,
65.24,
64.61,
64.09,
64.17,
64.20,
63.61,
63.74,
64.06,
64.18,
64.56,
64.81,
66.00,
71.07,
88.92,
98.02,
96.06,
91.44,
88.87,
85.28,
82.71,
80.18,
77.60,
75.35,
73.58,
71.24,
69.79,
68.27,
66.87,
66.04,
65.24,
64.26,
63.59,
63.06,
62.95,
62.79,
61.53,
57.38,
57.25,
58.49,
59.09,
60.80,
62.79,
64.50,
65.74,
65.97,
66.39,
67.56,
67.75,
67.62,
66.81,
66.69,
66.95,
66.51,
67.43,
67.58,
67.06,
64.27,
66.08,
66.39,
68.84,
77.01,
93.33,
99.01,
97.27,
94.44,
92.09,
89.38,
86.06,
82.68,
79.45,
76.61,
74.35,
72.55,
70.94,
69.72,
67.93,
67.18,
66.53,
65.76,
65.26,
65.37,
65.27,
66.08,
67.04,
66.30,
65.88,
63.46,
63.71,
65.76,
68.99,
70.68,
71.32,
71.65,
72.71,
73.34,
73.29,
72.25,
72.10,
72.42,
73.26,
73.71,
73.05,
72.32,
73.41,
72.81,
71.57,
71.60,
71.80,
77.53,
95.12,
101.49,
99.44,
95.51,
93.08,
90.13,
86.15,
83.01,
79.53,
76.87,
74.05,
71.97,
69.77,
69.14,
68.22,
67.24,
66.60,
66.21,
65.62,
65.51,
65.83,
66.69,
67.51,
66.87,
66.60,
64.22,
64.40,
66.17,
69.24,
70.66,
72.33,
72.95,
73.26,
73.13,
73.81,
73.30,
73.11,
73.02,
73.74,
72.83,
71.99,
72.44,
72.37,
71.56,
71.05,
70.75,
71.69,
76.71,
93.46,
100.48,
98.33,
96.22,
94.35,
91.96,
87.87,
84.69,
81.62,
78.64,
76.19,
73.71,
72.32,
71.39,
69.80,
68.98,
64.45,
65.87,
64.98,
64.02,
64.76,
66.63,
67.73,
66.04,
65.53,
63.49,
64.49,
67.47,
70.08,
71.56,
72.75,
74.01,
74.65,
75.77,
76.08,
75.56,
75.65,
76.04,
77.46,
77.31,
77.05,
79.20,
78.42,
76.93,
75.30,
75.15,
75.61,
79.58,
99.70,
107.63,
104.72,
101.38,
99.38,
95.81,
92.39,
88.25,
85.51,
82.43,
79.78,
77.88,
75.52,
73.64,
73.22,
72.17,
71.48,
70.70,
70.52,
69.60,
69.65,
70.31,
70.64,
69.05,
68.58,
66.84,
67.63,
70.09,
72.42,
75.17,
76.25,
77.58,
79.23,
80.03,
80.55,
79.87,
79.65,
79.63,
80.40,
80.31,
80.34,
80.63,
80.31,
79.71,
79.14,
78.34,
77.85,
82.04,
100.73,
107.80,
105.27,
101.49,
99.07,
96.07,
93.16,
89.42,
85.92,
83.52,
80.81,
78.37,
77.19,
75.84,
74.81,
73.90,
72.80,
72.05,
71.63,
71.09,
71.02,
71.16,
70.80,
67.61,
66.50,
65.91,
65.31,
66.51,
68.58,
69.98,
71.08,
72.77,
74.08,
74.47,
74.91,
74.38,
73.55,
73.11,
73.32,
72.42,
72.07,
72.78,
72.48,
72.33,
72.79,
73.45,
75.31,
78.94,
95.67,
103.58,
102.24,
99.20,
96.35,
93.19,
89.83,
87.13,
84.26,
81.54,
79.83
];

// Jumlah data per penjumlahan
$data_per_jumlah_harian = 48;
$data_per_jumlah_mingguan = 7;

// Inisialisasi variabel
$no = 1;
for ($i = 0; $i < count($data_beban); $i++) {
    ${"beban" . $no} = $data_beban[$i];
    $no++;
}
for ($i = 1; $i <= 28; $i++) {
    ${"energi_d" . $i} = 0;
}
for ($i = 1; $i <= 4; $i++) {
    ${"energi_m" . $i} = 0;
}
for ($m = 1; $m <= 4; $m++) {
    for ($d = 1; $d <= 7; $d++) { 
        ${"koef_d".$d."_m".$m} = 0;
    }
}
for ($m = 1; $m <= 28; $m++) {
    for ($d = 1; $d <= 48; $d++) { 
        ${"koef_j".$d."_d".$m} = 0;
    }
}
for ($i = 1; $i <= 7; $i++) {
    ${"total_koef_d".$i} = 0;
    ${"totalrata_koef_d".$i} = 0;
    ${"rata_koef_d".$i} = 0;
    ${"predic_energi_d".$i} = 0;
    for ($a=1; $a <= 48 ; $a++) { 
        ${"total_koef_d".$i."_j".$a} = 0;
        ${"rata_koef_d".$i."_j".$a} = 0;
        ${"d".$i."predicbeban_j".$a} = 0;
    }
}

// Proses penjumlahan energi harian
for ($i = 0; $i < count($data_beban); $i++) {
    // Menambahkan nilai data_beban ke variabel penjumlahan yang sesuai
    $index = ceil(($i + 1) / $data_per_jumlah_harian); // Menghitung indeks variabel penjumlahan
    ${"energi_d" . $index} += $data_beban[$i];
}
for ($i = 1; $i <= 28; $i++) {
    // Menambahkan nilai data_beban ke variabel penjumlahan yang sesuai
    ${"energi_d" . $i} /= 2;
    ${"energi_d" . $i} = round(${"energi_d" . $i}, 2);
    $energi_harian[] = ${"energi_d" . $i};
}


// Proses penjumlahan energi mingguan
for ($i = 0; $i < count($energi_harian); $i++) {
    // Menambahkan nilai data_beban ke variabel penjumlahan yang sesuai
    $index = ceil(($i + 1) / $data_per_jumlah_mingguan); // Menghitung indeks variabel penjumlahan
    ${"energi_m" . $index} += $energi_harian[$i];
}
for ($i = 1; $i <= 4; $i++) {
    $energi_mingguan[] = round(${"energi_m" . $i}, 2);
}

//function forecasting

function forecast($x, $known_y, $known_x) {
    $n = count($known_y);
    $mean_y = array_sum($known_y) / $n;
    $mean_x = array_sum($known_x) / $n;

    $diff_y = [];
    $diff_x = [];
    $diff_xy = [];

    for ($i = 0; $i < $n; $i++) {
        $diff_y[] = $known_y[$i] - $mean_y;
        $diff_x[] = $known_x[$i] - $mean_x;
        $diff_xy[] = $diff_y[$i] * $diff_x[$i];
    }

    $sum_xy = array_sum($diff_xy);
    $sum_xx = array_sum(array_map(function($x) { return $x * $x; }, $diff_x));

    $slope = $sum_xy / $sum_xx;
    $intercept = $mean_y - $slope * $mean_x;
    $forecast = $intercept + $slope * $x;

    return $forecast;
}

$rentan_historis = $energi_mingguan;
$rentan_waktu = [1, 2, 3, 4];
$nilai_x = 5; 

$hasil_prediksi = forecast($nilai_x, $rentan_historis, $rentan_waktu);

//menghitung koef harian per minggu
$hari = 1;
for ($i = 0; $i < count($energi_harian); $i++) {
    if ($hari == 8) {
        $hari = 1;
    }
    $index = ceil(($i + 1) / $data_per_jumlah_mingguan); 
    ${"koef_d".$hari."_m".$index} = $energi_harian[$i] / ${"energi_m" . $index};
    $hari++;
}

//rata - rata koef per hari
for ($d = 1; $d <= $data_per_jumlah_mingguan; $d++) { 
    for ($i=1; $i <= 4; $i++) {    
    ${"total_koef_d".$d} += ${"koef_d".$d."_m".$i};
    }
}
for ($i = 1; $i <= 7; $i++) {
    ${"rata_koef_d".$i} =  ${"total_koef_d".$i} / 4;
}

//prediksi total energi per hari
$total_koef_harian = 0;
for ($i = 1; $i <= 7; $i++) {
     $total_koef_harian += ${"rata_koef_d".$i};
}

for ($i = 1; $i <= 7; $i++) {
    ${"predic_energi_d".$i} = $hasil_prediksi * (${"rata_koef_d".$i} / $total_koef_harian);
}

//menghitung koef harian per 30 mmenit
$x = 1;
for ($i = 0; $i < count($data_beban); $i++) {
    if ($x == 49) {
        $x = 1;
    }
    $index = ceil(($i + 1) / $data_per_jumlah_harian); 
    ${"koef_j".$x."_d".$index} = $data_beban[$i] / ${"energi_d" . $index};
    $x++;
}

//rata - rata koef per 30 menit
$a = 1;
$x = 1;
for ($a = 1; $a <= 7; $a++){
for ($d = 1; $d <= $data_per_jumlah_harian; $d++) {
    for ($i=$x; $i <= 28; $i += 7) {    
    ${"total_koef_d".$a."_j".$d} += ${"koef_j".$d."_d".$i};
        // echo 'no '.$d.' '.  round(${"koef_j".$d."_d".$i},3);
    }
} 
$x++;
}
for ($i = 1; $i <= 7; $i++) {
    for ($a=1; $a <= 48 ; $a++) { 
       ${"rata_koef_d".$i."_j".$a} = ${"total_koef_d".$i."_j".$a} / 4;
    }
}

//prediksi total energi per 30 menit
for ($i = 1; $i <= 7; $i++) {
    for ($a=1; $a <= 48 ; $a++) { 
     ${"totalrata_koef_d".$i} += ${"rata_koef_d".$i."_j".$a};
    }
}
for ($i = 1; $i <= 7; $i++) {
    for ($a=1; $a <= 48 ; $a++) {
        ${"d".$i."predicbeban_j".$a} = (${"predic_energi_d".$i} * (${"rata_koef_d".$i."_j".$a} / ${"totalrata_koef_d".$i})) * 2;
    }
}


// echo "Hasil forecasting:\n";
echo "<br>Data Beban = [";
echo '<div class="page-beban">'; 
echo '<p>'; 
for ($i = 1; $i <= count($data_beban); $i++) {
    echo  ' '.${"beban" . $i};
}
echo '</p>';
echo '</div>';
echo "]";

echo "<br></br>Total Energi Per Hari = [";
echo '<div class="page-beban">'; 
echo '<p>'; 
for ($i = 1; $i <= 28; $i++) {
    echo  ' energi_d'.$i.': '. ${"energi_d" . $i};
}
echo '</p>';
echo '</div>';
echo "]";

echo "<br></br>Total Energi Per Minggu = [";
echo '<div class="page-beban">'; 
echo '<p>'; 
for ($i = 1; $i <= 4; $i++) {
    echo  ' energi_m'.$i.': '. ${"energi_m" . $i};
}
echo '</p>';
echo '</div>';  
echo "]";

echo "<br></br>Hasil forecasting";
echo ' ' . $hasil_prediksi;

echo "<br></br>Koefisian Per Minggu = [";
echo '<div class="page-beban">'; 
echo '<p>'; 
$x = 1;
for ($i = 0; $i < count($energi_harian); $i++) {
    if ($x == 8) {
        $x = 1;
        echo'<br></br>';
    }
    $index = ceil(($i + 1) / $data_per_jumlah_mingguan); 
    echo ' '.  round(${"koef_d".$x."_m".$index},3);
    $x++;
}
echo '</p>';
echo '</div>';  
echo "]";

echo "<br></br>Koefisian Harian = [";
echo '<div class="page-beban">'; 
echo '<p>'; 

for ($i = 1; $i <= 7; $i++) {
    echo ' ' .round(${"rata_koef_d".$i},3). ' ';
}
echo '</p>';
echo '</div>';  
echo "]";

echo "<br></br>Prediksi energi harian = [";
echo '<div class="page-beban">'; 
for ($i = 1; $i <= 7; $i++) {
echo '( hari ke-'.$i.' = ' . round(${"predic_energi_d".$i}, 2). ' ) ';
}
echo '</p>';
echo '</div>';  
echo "]";

echo "<br></br>Prediksi beban per 30 menit = [";
echo '<div class="page-beban">'; 
echo '<p>'; 
for ($i = 1; $i <= 7; $i++) {
    echo 'beban hari ke - '.$i. ' [';
    echo '<p class = "predic-beban">'; 
    for ($a=1; $a <= 48 ; $a++) {
        echo '( jam ke-'.$a.' = '.round(${"d".$i."predicbeban_j".$a}, 2). ' ) ';
    }
    echo '</p>'; 
    echo ']';
    echo '<br></br>';
}
echo '</p>';
echo '</div>';  
echo "]";

include 'config/conn.php';

for ($i = 1; $i <= 7; $i++) {
    echo '<script>alert("Perulangan hari ke '.$i.'")</script>';
    for ($a = 1; $a <= 48; $a++) {
        $day = $i;
        $beban = round(${"d".$i."predicbeban_j".$a}, 2);
        $query =  "INSERT INTO load_forcasting 
        VALUES(NULL, '$day', '$beban')";

        $result = mysqli_query($koneksi, $query);
        
    if(!$result){
        die ("Query gagal dijalankan: ".mysqli_error($koneksi).
            " - ".mysqli_error($koneksi));

    }
    }
}


  }
  ?>
</div>